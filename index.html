<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap');
            @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap');
            * {
                border: 0;
                padding: 0;
                margin: 0;
                outline: 0;
                user-select: none;
                color: #FFFFFF;
                transition: opacity 0.5s;
                font-family: 'Poppins', sans-serif;
            }
            body {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
            }
            .container {
                background-image: linear-gradient(150deg, #222222, #444444);
                width: 100%;
                height: 100%;
                position: relative;
                overflow: hidden;
            }
            .tab-content {
                position: absolute;
                top: 0;
                opacity: 0;
            }
            .logo {
                background-image: url(https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRyFAHMdON0ZEoBB-ieJazbUtgUCdaLn7HEAg&usqp=CAU);
                background-repeat: no-repeat;
                background-size: 140% 140%;
                background-position: center;
                width: calc(8.5vh - (2px * 2) - (4px * 2));
                height: calc(8.5vh - (2px * 2) - (4px * 2));
                border-radius: 50%;
                border: 4px solid #FFFFFF;
            }
            .status-ring {
                background-image: linear-gradient(150deg, rgba(255, 255, 255, .1), rgba(255, 255, 255, .1));
                border-radius: 50%;
                display: inline-block;
                position: absolute;
                top: 20px;
                left: 20px;
            }
            .status-ring .logo {
                margin: 3px;
            }
            .banner {
                position: relative;
                opacity: 0;
            }
            .settings-btn {
                position: absolute;
                color: #FFFFFF;
                font-size: calc(8.5vh / 2.5);
                background-color: rgba(0, 0, 0, 0);
                width: calc(8.5vh + 2px - (0px * 2) - (0px * 2));
                height: calc(8.5vh + 2px - (0px * 2) - (0px * 2));
                display: flex;
                align-items: center;
                justify-content: center;
                top: 9.5px;
                right: 2.5px;
                padding: 4px;
            }
            .content {
                margin: 15px;
                overflow: auto;
                margin-top: calc(8.5vh + 20px + 4px + (7.5px * 2) - (0px * 2) - (0px * 2));
            }
            .header-container {
                position: relative;
                margin-bottom: 32.5px;
            }
            .header {
                font-weight: 700;
                font-size: 17.5px;
                font-family: 'Lato', sans-serif;
            }
            .header-container .header {
                position: absolute;
                top: 0;
                left: 0;
            }
            .version-item {
                display: flex;
                text-align: left;
                margin-bottom: 5px;
                margin-left: 1.5px;
            }
            .version-item .info {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .version-item .title {
                color: #EEEEEE;
            }
            .version-item .symbol {
                color: #AAAAAA;
            }
            .version-item .image {
                height: 8vh;
                width: calc((8vh/16)*13);
                background-color: 	#d9675c;
                margin-right: 15px;
                border-radius: 2.5px;
            }
            .version-item .image .fa-bookmark {
                margin-left: 2px;
            }
            .view-all-btn {
                border-radius: 5px;
                background-color: rgba(0, 0, 0, 0);
                position: absolute;
                top: 0;
                right: 0;
            }
            .view-all-btn .fa-caret-right {
                margin-left: 5px;
            }
            .section {
                margin-bottom: 15px;
            }
            .navigation {
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                display: flex;
                opacity: 0;
            }
            .tab-btn {
                width: calc(100% / 4);
                height: auto;
                border: 0;
                margin: 0;
                padding: 0;
                background-color: rgba(0, 0, 0, 0);
                padding-bottom: 10px;
                padding-top: 10px;
                font-size: 1.25vh;
            }
            .tab-btn .fa-solid {
                font-size: 2vh;
                margin-bottom: 5px;
            }
            .controls {
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                display: flex;
            }
            .controls .selectables {
                width: 25%;
                font-size: 27.5px;
                background-color: rgba(0, 0, 0, 0);
                padding: calc(27.5px / 1.5);
            }
            .controls .information {
                font-size: 12.5px;
                width: calc(100% - (25% * 2));
                text-align: center;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .bible-content {
                background-color: #2e2e2e;
                padding: 10px;
                height: calc(100% - 77px - 20px);
                overflow-y: auto;
            }
            .bible-content div {
                padding: 5px;
            }
            .progress {
                background-color: rgba(0, 0, 0, 0.1);
                height: 4px;
                width: 200px;
                margin-top: 10px;
            }
            .progress div {
                background-color: rgba(255, 255, 255, 0.5);
                height: 4px;
                width: 0%;
            }
            #logo-page {
                display: flex;
                justify-content: center;
                align-items: center;
            }
            #logo-page .logo {
                width: 9vh;
                height: 9vh;
            }
            #my-bibles-page .content .header {
                margin-bottom: 10px;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="banner">
                <div class="status-ring">
                    <div class="logo"></div>
                </div>
            </div>
            <div class="tab-content" id="logo-page">
                <div class="logo"></div>
            </div>
            <div class="tab-content" id="home-page">
                <div class="content">
                    <div class="header-container">
                        <div class="header">Bible Versions</div>
                        <button class="view-all-btn" onclick="selectTab(2)">
                            View All
                            <i class="fa-solid fa-caret-right"></i>
                        </button>
                    </div>
                    <div class="section">
                        <div id="versions-section"></div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="my-bibles-page">
                <div class="content">
                    <div class="header">My Bibles</div>
                    <div class="section">
                        <div id="bibles-section"></div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="bible-viewer">
                <div class="bible-content">A</div>
                <div class="controls">
                    <button class="selectables" id="previous">
                        <i class="fa-solid fa-caret-left"></i>
                    </button>
                    <div class="information">
                        <div class="frame">
                            <div id="book-name"></div>
                            <div id="chapter-name"></div>
                            <div class="progress">
                                <div id="juice"></div>
                            </div>
                        </div>
                    </div>
                    <button class="selectables" id="next">
                        <i class="fa-solid fa-caret-right"></i>
                    </button>
                </div>
            </div>
            <div class="navigation">
                <button class="tab-btn" id="home-page-btn" onclick="selectTab(1)">
                    <i class="fa-solid fa-house"></i><br>
                    Home
                </button>
                <button class="tab-btn" id="my-bibles-page-btn" onclick="selectTab(2)">
                    <i class="fa-solid fa-bookmark"></i><br>
                    My Bibles
                </button>
                <button class="tab-btn" id="discovery-btn">
                    <i class="fa-solid fa-compass"></i><br>
                    Discovery
                </button>
                <button class="tab-btn" id="settings-btn">
                    <i class="fa-solid fa-gear"></i><br>
                    Settings
                </button>
            </div>
        </div>
    </body>
    <script>
        function selectTab(number) {
            setTimeout(function(){
                const tabs = document.getElementsByClassName("tab-content")
                const container = document.getElementsByClassName("container")[0]
                const buttons = document.getElementsByClassName("tab-btn")
                const navigation = document.getElementsByClassName("navigation")[0]
                const ring = document.getElementsByClassName("banner")[0]
                for (var tab in tabs) {
                    tab = [tab, tabs[tab]]
                    if (tab[1].id !== undefined) {
                        tab[1].style.width = container.offsetWidth + "px"
                        tab[1].style.height = container.offsetHeight + "px"
                        if (parseInt(tab[0]) === number) {
                            tab[1].style.left = "0px"
                            tab[1].style.opacity = 1
                            if ([1, 2].includes(number)) {
                                navigation.style.opacity = 1
                                navigation.style.left = 0
                                ring.style.opacity = 1
                                ring.style.left = 0
                                for (var button in buttons) {
                                    button = buttons[button]
                                    if (button.id !== undefined) {
                                        if (tab[1].id + "-btn" === button.id) {
                                            button.style.opacity = 1
                                        } else {
                                            button.style.opacity = 0.5
                                        }
                                    }
                                }
                            } else {
                                navigation.style.opacity = 0
                                navigation.style.left = container.offsetWidth + "px"
                                ring.style.opacity = 0
                                ring.style.left = container.offsetWidth + "px"
                            }
                        } else {
                            tab[1].style.left = container.offsetWidth + "px"
                            tab[1].style.opacity = 0
                        }
                    }
                }
            }, 0)
        }
    </script>
    <script>
        socket = new WebSocket(`wss://ilc-servers.herokuapp.com`)
        socket.addEventListener("open", () => {
            socket.addEventListener("message", (data) => {
                packet = JSON.parse(data.data.toString())
                if (packet.type === "response") {
                    if (packet.action === "user-token") {
                        selectTab(0)
                        localStorage.setItem("cache", JSON.stringify({
                            token: packet.data.token
                        }))
                        socket.send(JSON.stringify({
                            type: "request",
                            action: "info",
                            headers: {
                                token: JSON.parse(localStorage.getItem("cache")).token
                            }
                        }))
                    } else if (packet.action === "info") {
                        /* Home Page */
                        if (packet.data.service_started) {
                            document.getElementsByClassName("status-ring")[0].style.backgroundImage = "linear-gradient(315deg, #726cf8 0%, #e975a8 74%)"
                        }
                        document.getElementById("versions-section").innerHTML = ""
                        for (var version in packet.data.versions) {
                            version = [document.createElement("button"), packet.data.versions[version], version]
                            if (version[2] < 2) {
                                version[0].style.backgroundColor = "rgba(0, 0, 0, 0)"
                                version[0].data = (version[1].symbol + version[1].name.length.toString()).toLowerCase()
                                version[0].onclick = function() {
                                    socket.send(JSON.stringify({
                                        type: "request",
                                        action: "bible-data",
                                        headers: {
                                            id: this.data,
                                            token: JSON.parse(localStorage.getItem("cache")).token
                                        }
                                    }))
                                }
                                version[0].innerHTML = `
                                    <div class="version-item">
                                        <div class="image">
                                            <i class="fa-solid fa-bookmark"></i>
                                        </div>
                                        <div class="info">
                                            <div class="frame">
                                                <div class="title">${version[1].name}</div>
                                                <div class="symbol">${version[1].symbol}</div>
                                            </div>
                                        </div>
                                    </div>
                                `
                                document.getElementById("versions-section").appendChild(version[0])
                            }
                        }
                        /* Bible Page */
                        for (var version in packet.data.versions) {
                            version = [document.createElement("button"), packet.data.versions[version], version]
                            version[0].style.backgroundColor = "rgba(0, 0, 0, 0)"
                            version[0].data = (version[1].symbol + version[1].name.length.toString()).toLowerCase()
                            version[0].onclick = function() {
                                socket.send(JSON.stringify({
                                    type: "request",
                                    action: "bible-data",
                                    headers: {
                                        id: this.data,
                                        token: JSON.parse(localStorage.getItem("cache")).token
                                    }
                                }))
                            }
                            version[0].innerHTML = `
                                <div class="version-item">
                                    <div class="image">
                                        <i class="fa-solid fa-bookmark"></i>
                                    </div>
                                    <div class="info">
                                        <div class="frame">
                                            <div class="title">${version[1].name}</div>
                                            <div class="symbol">${version[1].symbol}</div>
                                        </div>
                                    </div>
                                </div>
                            `
                            document.getElementById("bibles-section").appendChild(version[0])
                        }
                        setTimeout(function() {
                            selectTab(1)
                        }, 1500)
                    } else if (packet.action === "bible-data") {
                        document.getElementsByClassName("bible-content")[0].identifier = packet.data.id
                        document.getElementById("juice").max = packet.data.count
                        localStorage.setItem("chapter", 1)
                        socket.send(JSON.stringify({
                            type: "request",
                            action: "bible-chunk",
                            headers: {
                                token: JSON.parse(localStorage.getItem("cache")).token,
                                id: document.getElementsByClassName("bible-content")[0].identifier,
                                filter: 1
                            }
                        }))
                    } else if (packet.action === "bible-chunk") {
                        /* Data Handling */
                        document.getElementsByClassName("bible-content")[0].innerHTML = ""
                        document.getElementById("book-name").textContent = packet.data.name[0]
                        document.getElementById("chapter-name").textContent = "Chapter " + packet.data.name[1].toString()
                        packet.data.chapter.verses.forEach((verse) => {
                            item = document.createElement("div")
                            item.innerHTML = `
                                ${verse[1]}
                            `
                            document.getElementsByClassName("bible-content")[0].appendChild(item)
                        })
                        /* Output */
                        if ((parseInt(localStorage.getItem("chapter")) -1) < 1) {
                            document.getElementById("previous").style.opacity = 0
                            document.getElementById("next").onclick = function() {
                                localStorage.setItem("chapter", parseInt(localStorage.getItem("chapter")) + 1)
                                socket.send(JSON.stringify({
                                    type: "request",
                                    action: "bible-chunk",
                                    headers: {
                                        token: JSON.parse(localStorage.getItem("cache")).token,
                                        id: document.getElementsByClassName("bible-content")[0].identifier,
                                        filter: parseInt(localStorage.getItem("chapter")) 
                                    }
                                }))
                            }
                            document.getElementById("previous").onclick = function() {}
                        } else {
                            document.getElementById("previous").style.opacity = 1
                            document.getElementById("next").onclick = function() {
                                localStorage.setItem("chapter", parseInt(localStorage.getItem("chapter")) + 1)
                                socket.send(JSON.stringify({
                                    type: "request",
                                    action: "bible-chunk",
                                    headers: {
                                        token: JSON.parse(localStorage.getItem("cache")).token,
                                        id: document.getElementsByClassName("bible-content")[0].identifier,
                                        filter: parseInt(localStorage.getItem("chapter")) 
                                    }
                                }))
                            }
                            document.getElementById("previous").onclick = function() {
                                localStorage.setItem("chapter", parseInt(localStorage.getItem("chapter")) - 1)
                                socket.send(JSON.stringify({
                                    type: "request",
                                    action: "bible-chunk",
                                    headers: {
                                        token: JSON.parse(localStorage.getItem("cache")).token,
                                        id: document.getElementsByClassName("bible-content")[0].identifier,
                                        filter: parseInt(localStorage.getItem("chapter")) 
                                    }
                                }))
                            }
                        }
                        document.getElementById("juice").style.width = ((parseInt(localStorage.getItem("chapter"))/document.getElementById("juice").max) * 100) + "%"
                        selectTab(3)
                    }
                }
            })
            socket.send(JSON.stringify({
                type: "request",
                action: "user-token",
                headers: null
            }))
        })
    </script>
</html>
